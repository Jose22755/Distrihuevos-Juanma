<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cambiar Contraseña</title>
  <link rel="stylesheet" href="../css/reset_password.css">
</head>
<body>
  <div class="reset-container">
    <h2>🔒 Cambiar Contraseña</h2>
    <p>Ingresa tu correo y tu contraseña actual para establecer una nueva.</p>

    <form id="resetForm">
      <div class="form-group">
        <label for="email">Correo electrónico</label>
        <input type="email" id="email" placeholder="ejemplo@gmail.com" required>
        <small class="error" id="emailError"></small>
      </div>

      <div class="form-group">
        <label for="currentPassword">Contraseña actual</label>
        <input type="password" id="currentPassword" placeholder="Contraseña actual" required>
        <small class="error" id="currentPasswordError"></small>
      </div>

      <div class="form-group">
        <label for="newPassword">Nueva contraseña</label>
        <input type="password" id="newPassword" placeholder="Nueva contraseña" required>
        <small class="error" id="newPasswordError"></small>
      </div>

      <button type="submit" id="resetBtn">Cambiar Contraseña</button>

      <a href="login.html" class="back-link">← Volver al inicio de sesión</a>
    </form>

    
  </div>

  <div class="success-message" id="successMessage">
    ✅ Contraseña actualizada correctamente

    
  </div>

  <footer>© 2025 Distrihuevos JUANMA</footer>


  

  <script>
    const resetForm = document.getElementById('resetForm');
    const email = document.getElementById('email');
    const currentPassword = document.getElementById('currentPassword');
    const newPassword = document.getElementById('newPassword');

    const emailError = document.getElementById('emailError');
    const currentPasswordError = document.getElementById('currentPasswordError');
    const newPasswordError = document.getElementById('newPasswordError');
    const successMessage = document.getElementById('successMessage');

    // Expresión regular igual a la del registro
    const passwordRegex = /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[!@#$%^&*])(?!.*\s).{8,}$/;

    resetForm.addEventListener('submit', (e) => {
      e.preventDefault();

      // Limpiar mensajes previos
      emailError.textContent = '';
      currentPasswordError.textContent = '';
      newPasswordError.textContent = '';

      let valid = true;

      if (email.value.trim() === '') {
        emailError.textContent = 'Por favor ingresa tu correo electrónico.';
        valid = false;
      }

      if (currentPassword.value.trim() === '') {
        currentPasswordError.textContent = 'Por favor ingresa tu contraseña actual.';
        valid = false;
      }

      const val = newPassword.value.trim();
      if (!passwordRegex.test(val)) {
        newPasswordError.textContent =
          'Contraseña: mínimo 8 caracteres, mayúscula, minúscula, número y símbolo (!@#$%^&*)';
        valid = false;
      }

      if (valid) {
        successMessage.classList.add('show');
        resetForm.reset();
        setTimeout(() => successMessage.classList.remove('show'), 3000);
      }
    });

    // Quitar mensaje de error al escribir de nuevo
    [email, currentPassword, newPassword].forEach((input) => {
      input.addEventListener('input', () => {
        const errorField = document.getElementById(input.id + 'Error');
        errorField.textContent = '';
      });
    });
  </script>

  
</body>
</html>
